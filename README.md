# **AquaSense – n8n Workflows Versioning**

[![standard-readme compliant](https://img.shields.io/badge/readme%20style-standard-brightgreen.svg?style=flat-square)](https://github.com/RichardLitt/standard-readme)

A version-controlled repository for managing backup copies of all n8n workflows created for the academic automation project **AquaSense - Intelligent Water Management**, developed as part of the course **Operations and Process Strategy (PRI2IS)** at **Escuela Colombiana de Ingeniería Julio Garavito**.

This repository ensures traceability, reproducibility, and structured evolution of the Low-Code automation artifacts used to simulate SCADA, ERP and CRM data consolidation through n8n, Supabase, Azure Free Tier, Grafana, and Gemini-based anomaly detection.

## **Table of Contents**

- [Background](#background)
- [Install](#install)
- [Usage](#usage)
  - [Workflow Structure](#workflow-structure)
- [Process Architecture](#process-architecture)
  - [AS-IS (Simplified)](#as-is-simplified)
  - [AS-IS (Detailed)](#as-is-detailed)
  - [TO-BE (High Level)](#to-be-high-level)
  - [TO-BE (Detailed)](#to-be-detailed)
  - [Deployment Diagram](#deployment-diagram)
- [Documentation](#documentation)
- [Related Efforts](#related-efforts)
- [Maintainers](#maintainers)
- [Contributors](#contributors)
- [License](#license)

## **Background**

The project simulates data ingestion from SCADA, ERP and CRM systems using Supabase tables. n8n acts as the orchestration engine for:

- automated data extraction, cleaning, and consolidation
- anomaly detection using Gemini AI
- workflow resilience through retries, error handling, and logging
- automated Grafana dashboard refreshes
- Teams/email alerts for anomalies or critical events

Keeping workflow backups in GitHub enables:

- versioning of automation artifacts
- rollback mechanisms
- team collaboration
- reproducibility for academic evaluation

## **Install**

This repository contains only exported workflow files (`.json`) and documentation.
To execute the workflows locally:

1. Install **Docker**
2. Run n8n:

   ```sh
   docker run -it --rm \
     -p 5678:5678 \
     -v ~/.n8n:/home/node/.n8n \
     n8nio/n8n
   ```

3. Import workflows from the n8n UI (`Settings -> Workflows -> Import`).

## **Usage**

Clone the repository:

```sh
git clone https://github.com/LePeanutButter/n8n-workflows-aquasense.git
```

> Note: n8n automatically encrypts workflow names upon export.
> Workflow file names do not follow a readable naming scheme; each file is a unique hash generated by n8n.

### **Workflow Structure**

Typical workflow components include:

- **Schedule Trigger** - periodic execution
- **Supabase nodes** - fetch SCADA/ERP/CRM data
- **Function nodes** - data merging and validation
- **AI API call** - anomaly detection (Gemini)
- **Supabase write-back** - store results and logs
- **Grafana Supabase metrics** - dataset refresh
- **Teams/Email notifications** - alerts and reporting

## **Process Architecture**

A complete description of the current and target operational model of the AquaSense automation ecosystem.

### **AS-IS (Simplified)**

Current state without integrated automation:

- Data is captured manually or extracted independently from SCADA, ERP and CRM.
- No centralized or automated integration process.
- Data validation and consolidation are manual and error-prone.
- No automated anomaly detection.
- Reports are generated only on demand and are not real-time.

![Simplified AS-IS](img/simplified-as-is.png)

### **AS-IS (Detailed)**

Detailed description of the traditional, manual process:

1. Operators export SCADA data manually (CSV or platform export).
2. Administrative staff retrieves ERP and CRM information independently.=
3. All datasets are manually consolidated, often in Excel.
4. Validation relies on the analyst’s subjective judgment.
5. Reports are generated manually and sent by email as needed.
6. No automated alerts, no unified log of changes, and no traceability.

![Detailed AS-IS](img/detailed-as-is.png)

### **TO-BE (High-Level)**

Future state with full implementation of the n8n–Supabase–Gemini–Grafana ecosystem:

- Automated ingestion of SCADA, ERP and CRM data.
- Centralized and automated data transformation and validation.
- AI-driven anomaly detection using Gemini.
- Real-time dashboards updated automatically in Grafana.
- Automated alerts through Teams and email.
- End-to-end traceability with logs stored in Supabase.
- Stable versioning of workflows in GitHub for reproducibility.

![High-Level TO-BE](img/high-level-to-be.png)

### **TO-BE (Detailed)**

Detailed description of the improved automated flow:

1. Scheduled triggers periodically pull data from all sources.
2. n8n normalizes, cleans, and merges the datasets.
3. Gemini evaluates time-series behavior to detect anomalies.
4. Both data and anomaly results are stored in Supabase.
5. Grafana dashboards automatically refresh using Supabase datasets.
6. n8n sends notifications for anomalies or critical events.
7. A structured audit trail of all workflow executions is maintained.

![Detailed TO-BE](img/detailed-to-be.png)

### **Deployment Diagram**

Representation of runtime deployment across cloud environments:

![Deployment Diagram](img/deployment-diagram.png)

## **Documentation**

All reports and analysis documents are located in the [docs/](/docs/)
folder.

- [Informe de Análisis](/docs/analisis_sistemico_aqualia.pdf)

Additional documents will also be stored in this directory for easy reference.

> **Note:** All analysis reports are written in **Spanish**.

## **Related Efforts**

- [n8n Documentation](https://docs.n8n.io)
- [Supabase](https://supabase.com)
- [Grafana](https://grafana.com/)
- [System Thinking & Causal Loops](https://thesystemsthinker.com/)

## **Maintainers**

[LePeanutButter](https://github.com/LePeanutButter) - Santiago Botero

## **Contributors**

This project exists thanks to all the people who contribute.

- [andrescalderonr](https://github.com/andrescalderonr) - Andrés Felipe Calderón
- [Lanapequin](https://github.com/Lanapequin) - Laura Natalia Perilla
- [lRicardol](https://github.com/lRicardol) - Ricardo Andrés Ayala
- [SantiagoAmaya21](https://github.com/SantiagoAmaya21) - Santiago Amaya
- [LePeanutButter](https://github.com/LePeanutButter) - Santiago Botero

## **License**

[MIT](/LICENSE) © AquaSense Team

---

This **README** follows the Standard Readme specification.
